---
Title: トレース - 送信したトレースを確認する
Date: 2025-04-18T10:27:15+09:00
URL: https://mackerel.io/ja/docs/entry/tracing/features/trace-list
EditURL: https://blog.hatena.ne.jp/mackerelio/mackerelio-docs-ja.hatenablog.mackerel.io/atom/entry/6802418398351034325
---

トレース一覧画面では、アプリケーション内のサービスごとに送信されたトレースを一覧で確認できます。

[:contents]

## フィルター条件

トレース一覧画面では、フィルターの「サービス」に指定したサービスや、「条件」に指定した発生日時などの条件に一致するトレースの一覧が表示されます。トレース一覧は「並べ替え」で発生順やレイテンシー順で並び替えることもできます。

<figure class="figure-image figure-image-fotolife" title="フィルター">[f:id:mackerelio:20250410144820p:plain]<figcaption>フィルター</figcaption></figure>

フィルター条件は、「最後に発生してから1時間」といった簡易的な時間指定や、以下の項目による詳細な条件指定ができます。

| 項目              | 内容                                                                     |
|-------------------|-------------------------------------------------------------------------|
| サービス              | トレーススパンに含まれる `service.name` の値                                               |
| Service namespace | トレーススパンに含まれる `service.namespace` の値                                    |
| デプロイ環境          | トレーススパンに含まれる `deployment.environment` または `deployment.environment.name` の値 |
| 発生              | トレースの発生日時                                                                 |
| 課題              | 課題のID。課題詳細画面のURL末尾の英数字（`tracing/issues/<id>`）               |
| トレースID            | トレース一覧やトレース詳細画面に表示されるトレースのID                                     |
| Span 名            | トレース詳細画面に表示されるスパンごとの `name` の値                                    |
| レイテンシー            | レイテンシーの条件を、以上、以下、範囲で指定                                         |
| 属性              | 属性の値の条件を指定                                                    |
| リソース              | リソースの値の条件を指定                                                    |


## レイテンシーの分布

レイテンシーの分布がヒートマップで表示されます。横軸が時間推移（右にいくほど新しい）、縦軸がレイテンシー（上にいくほど時間がかかっている）です。

ヒートマップ上の時間帯・レイテンシーに存在するトレースのおおよその数が、右上の凡例にある通り表示されます。マウスオーバーすることで実際の数が確認できます。ドラッグして範囲指定することで、その範囲についてドリルダウンして調べることもできます。

<figure class="figure-image figure-image-fotolife" title="レイテンシーの分布">[f:id:mackerelio:20250410144835p:plain]<figcaption>レイテンシーの分布</figcaption></figure>


## トレース一覧

トレース一覧には以下の内容が表示されます。

| 項目         | 内容                                                                                                                                        |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| トレースID       | トレースのID                                                                                                                                      |
| リクエスト        | `http.method`（リクエストメソッド）や`http.route`（リクエストパス）の値。`deployment.environment` または `deployment.environment.name` 属性が存在する場合はその値（デプロイ環境） |
| トレース発生時刻 | トレースの発生日時                                                                                                                              |
| レイテンシー       | トレースの合計時間                                                                                                                               |
| サービス         | `service.name`（サービス名）や `service.namespace`（サービスネームスペース）の値                                                                                 |
| サービス発生時刻 | フィルター条件にしているサービスのスパンが発生した日時                                                                                                                     |
| サービスレイテンシー   | フィルター条件にしているサービスのスパンの合計時間                                                                                                                       |

<figure class="figure-image figure-image-fotolife" title="トレース一覧">[f:id:mackerelio:20250410144857p:plain]<figcaption>トレース一覧</figcaption></figure>

### トレースの集計

トレース一覧右上の「集計」ボタンをクリックすると、トレース一覧のスパンの属性について、その値の比率を表示します。

たとえば `http.route` 属性はリクエストパス、`http.status_code` 属性はレスポンスのステータスコードを示しますが、どのようなリクエストパスが多いのかや、レスポンスのエラー率などを見てとることができます。

<figure class="figure-image figure-image-fotolife" title="集計">[f:id:mackerelio:20250410144914p:plain]<figcaption>集計</figcaption></figure>


## トレース詳細画面

トレース一覧のトレースをクリックすると、そのトレースの詳細を確認できます。

トレース詳細画面ではスパンの状況が可視化されます。横軸が時間推移（右にいくほど新しい）で、縦に並んだスパンは同時に行われた処理、横に並んだスパンは順番に行われた処理であることがわかります。表示されたスパンをクリックすることで、そのスパンの属性が確認できます。ドラッグして範囲指定することで、その範囲についてドリルダウンして調べることもできます。

トレースに `service.name` 属性や、`host.id` あるいは `host.name` 属性が存在する場合には、画面上部のサービスやホストの箇所に「メトリック」というリンクが表示されます（※）。このリンクを経由すると、トレースに含まれているサービスやホストなどの属性で絞り込み、かつ発生日時周辺に表示範囲を絞り込んだ状態の、メトリックエクスプローラー画面へ遷移できます。

※`host.id` と `host.name` では、`host.id` を優先します。また、`service.namespace` 属性が存在する場合は、あわせて絞り込み条件に含まれるようになります。

<figure class="figure-image figure-image-fotolife" title="トレース詳細画面">[f:id:mackerelio:20250410144942p:plain]<figcaption>トレース詳細画面</figcaption></figure>
